# keikaidenwa-csvutil

文字化けやエラーなどが生じる軽快電話のCSVを、可能な限り修正する

## 概要

携帯万能は、内部的にCP932を使用するが、本文がUTF-8である場合にはそのままUTF-8で本文を保持してしまい、エラーになる。
CSVにエクスポートした場合でも本文エントリはUTF-8となり、ファイルがbinary扱いになり厄介。

この問題を修正し、全体をCSVのUTF-8に変換する。

変換にはNKFを外部コマンドとして使用している。

## 使い方

エクスポートしたCSVを読ませると、最終的には`keitaibannou-out.csv`を生成する。

Zsh版はold versionである。

	keitai-bannou-conv.pl sendmails.csv

入力はARGFを読んでいる。

## 注意

現在、携帯万能は`"`をエスケープしない。そのため、本文中に`"`があるとパースできないCSVが出来上がる。

現状、このユーティリティは無理やりに処理し、パースできなくてもテキストエディタでは読めるCSVを吐こうとする。ただし、`,"`で始まるエントリ、`",`で終わるエントリ、`","`を含むエントリが存在した場合、境界を判断する方法がないため、正しく動作しない。

この問題は既にPLANEXに報告済みである。

修正された場合、このプログラムを修正しなければ正しく動かない。

## Windows

動作はLinuxで確認しているが、NKFコマンドがあればWindowsでも多分動く。

WindowsのソフトだからWindowsで動かないと意味がない、と思うかもしれないが、私がLinuxを使っているのでLinuxで動かしている。

Windowsで利用する場合はPerl処理系も別途用意すること。
